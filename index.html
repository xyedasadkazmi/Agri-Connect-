{% extends 'base.html' %}
{% block content %}
<div class="container mt-5">

  <!-- Header & Add New Blog Button -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="text-success fw-bold">ğŸ“ Blogs</h2>
    {% if current_user.is_authenticated %}
    <a href="{{ url_for('new_blog') }}" class="btn btn-success">+ Add New Blog</a>
    {% else %}
    <a href="{{ url_for('login') }}" class="btn btn-outline-success">Login to Add</a>
    {% endif %}
  </div>

  <!-- Blogs Listing -->
  {% if blogs %}
  <div class="row">
    {% for blog in blogs %}
    <div class="col-md-6 mb-4">
      <div class="card h-100 shadow-sm hover-shadow rounded">
        {% if blog.image %}
        <img src="{{ url_for('static', filename='uploads/' ~ blog.image) }}" 
             class="card-img-top rounded-top" alt="{{ blog.title }}" style="height:200px; object-fit:cover;">
        {% endif %}
        <div class="card-body d-flex flex-column">
          <h5 class="card-title text-success fw-bold">{{ blog.title }}</h5>
          <p class="text-muted mb-2" style="font-size:0.9rem;">
            ğŸ•’ {{ blog.created_at.strftime('%Y-%m-%d') }}
            {% if blog.user %}by <strong>{{ blog.user.name }}</strong>{% endif %}
          </p>
          <p class="card-text flex-grow-1" style="white-space: pre-line; overflow:hidden; max-height:80px;">
            {{ blog.content[:150] }}{% if blog.content|length > 150 %}...{% endif %}
          </p>
          <a href="{{ url_for('view_blog', blog_id=blog.id) }}" class="btn btn-outline-success mt-2">Read More</a>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <p class="text-muted text-center">No blogs yet. {% if current_user.is_authenticated %}Click "Add New Blog" to create one!{% endif %}</p>
  {% endif %}

</div>

<style>
.hover-shadow:hover {
  transform: translateY(-5px);
  box-shadow: 0 0.5rem 1rem rgba(0,0,0,0.15);
}
</style>
{% endblock %}
